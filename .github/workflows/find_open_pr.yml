name: "Open PR's"
run-name: Find open pull requests v6 ðŸ·ï¸
on: push
  # schedule:
  #  - cron: "*/15 * * * *"

jobs:
  active-pull-request:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
   # - name: Print Active PR's
   #   run: | 
   #     openPrs="$(gh pr list --json title,url)"
   #     echo 'OPEN_PULL_REQUESTS='$openPrs >> $GITHUB_ENV
      env:
        GH_TOKEN: ${{ github.token }}
    - name: Colleting Open Pull Requests
      run: |
        #echo "Current Repo - ${{ github.event.repository.name }}"
        openPrs="$(gh pr list --json title,url)"
        echo 'OPEN_PULL_REQUESTS='$openPrs
        ALL_PR_MESSAGES=""
        for row in $(echo "${OPEN_PULL_REQUESTS}" | jq -r '.[] | @base64'); do
          _jq() {
            echo ${row} | base64 --decode | jq -r ${1}
          }
          title=$(_jq '.title')
          url=$(_jq '.url')
          ALL_PR_MESSAGES+="â€¢ <$url|$title>\n"
        done
        echo "For the Slack - $ALL_PR_MESSAGES"
    - name: Send Slack Message
        

