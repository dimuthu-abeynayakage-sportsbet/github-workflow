name: "Open PR's"
run-name: Find open pull requests v3 ðŸ·ï¸
on: push
  # schedule:
  #  - cron: "*/15 * * * *"

jobs:
  active-pull-request:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    # Find the PR associated with this push, if there is one.
    #- uses: jwalton/gh-find-current-pr@master
    #  id: findPr
    #  with:
      # Can be "open", "closed", or "all".  Defaults to "open".
    #    state: open
    # This will echo "Your PR is 7", or be skipped if there is no current PR.
    #- run: echo "Your PR is ${PR}, ${{ steps.findPr.outputs.pr }}, ${{steps.findPr.outputs.number}}"
    #- name: list all closed pull requests in last 24 hours
    - name: Print Active PR's
      run: | 
        #git config --global user.name ${{ github.triggering_actor }}
        #git config --global user.email dimuthu.abeynayakage@sportsbet.com.au
        openPrs="$(gh pr list --json createdAt,title,url)"
        echo 'OPEN_PULL_REQUESTS='$openPrs >> $GITHUB_ENV
      env:
        GH_TOKEN: ${{ github.token }}
    - name: Print -----------
      run: |
        echo "OPEN_PULL_REQUESTS - $OPEN_PULL_REQUESTS"
        echo "Current Repo - ${{ github.event.repository.name }}"
        jq -c '.[]' OPEN_PULL_REQUESTS | while read PR; do
          echo "title ----> $PR['title']"
        done
        

